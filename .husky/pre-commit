#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "🎨 Auto-formatting code..."

# Auto-stage Memory Bank changes if any
git add .claude/memory-bank/*.md 2>/dev/null

# Auto-format the solution file
dotnet format BlockLife.sln --verbosity quiet

if [ $? -ne 0 ]; then
  echo "❌ Format command failed!"
  echo ""
  echo "To bypass: git commit --no-verify"
  exit 1
fi

# Check if formatting made changes
if [[ -n $(git diff --name-only) ]]; then
  echo "📝 Files were auto-formatted. Adding changes..."
  git add -u
  echo "✅ Format applied and staged"
else
  echo "✅ Code already properly formatted"
fi